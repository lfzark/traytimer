# TrayTimer - 极简跨平台托盘计时器

**单文件、极简、零打扰的系统托盘计时器**  
支持 **Windows / Linux**，专注于不打扰和高效使用。

- 正计时  
- 倒计时（支持秒数、`m:s`、`HH:MM`、`HH:MM:SS` 结束时间）  
- 事件命名 + 自动日志记录  
- 倒计时结束可持续计时并显示已超时长（如 `-00:00:05`）  
- 托盘图标闪烁、通知提醒（支持 3 秒自动隐藏）  
- 无需安装/打包，一行命令运行

---

## 功能一览

| 功能            | 说明                                                        |
|-----------------|-------------------------------------------------------------|
| 正计时          | 右键菜单选择“正计时”，输入事件名开始                       |
| 倒计时          | 右键菜单选择“倒计时”，支持秒数/分秒/时分/时分秒多种格式输入 |
| 结束时间模式    | 输入目标时间点（HH:MM/HH:MM:SS），自动倒计时至该时间点      |
| 跨天处理        | 目标时间已过则自动算到明天                                  |
| 超时显示        | 倒计时结束后继续计时并显示超时秒数                          |
| 事件名称        | 每次计时前都需输入，自动记录到日志                          |
| 日志文件        | `~/.config/timer.log`（Linux）或 `%APPDATA%\timer.log`（Windows） |
| 托盘闪烁        | 计时结束后图标闪烁提醒                                      |
| 通知提醒        | 计时结束后弹系统通知（3 秒隐藏）                            |
| 停止            | 右键菜单点击“停止”立即记结束时间                           |
| 退出            | 右键菜单点击“退出”关闭程序                                 |

---

## 运行与安装

### 1. 安装依赖
```bash
pip install pyqt5
```

### 2. 保存代码
将最新 `traytimer.py` 代码保存到本地。

### 3. 运行
```bash
python traytimer.py
```

启动后会在系统托盘出现图标，可通过右键菜单操作。

---

## Windows 图标问题

如果报错 `QSystemTrayIcon::setVisible: No Icon set`，请确保有可用图标。

推荐做法：

- 方法A：下载一个 `.ico` 文件（如 [clock icon](https://www.iconarchive.com/show/simple-icons-by-paomedia/Clock-icon.html)），重命名为 `timer.ico` 放在同目录；
- 方法B：代码已自动使用系统图标兜底，无需单独准备。

---

## 操作流程简介

1. 点右键菜单选择“正计时”或“倒计时”，输入事件名。
2. 倒计时时可在弹窗选择：
   - 秒数(`90`)
   - 分钟:秒(`1:30`)
   - 结束时间HH:MM(`15:10`)
   - 结束时间HH:MM:SS(`15:10:10`)
3. 计时进行中可随时右键“停止”或等待倒计时结束。
4. 日志自动保存每次事件到本地。

---

## 日志示例

日志文件路径：
- Linux: `~/.config/timer.log`
- Windows: `%APPDATA%\timer.log`

日志样例：
```log
[2025-11-17 14:20:15] 正计时开始: 工作
[2025-11-17 14:45:30] 正计时结束: 工作 | 用时: 00:25:15

[2025-11-17 14:50:00] 倒计时开始 (HH:MM): 喝咖啡 | 用时: 00:05:00
[2025-11-17 14:50:00] 目标时间: 14:55:00
[2025-11-17 14:55:10] 倒计时结束: 喝咖啡 | 用时: 00:05:10
```

---

## 输入支持格式详解

| 输入格式      | 含义                               |
|--------------|------------------------------------|
| `90`         | 90 秒                              |
| `1:30`       | 1 分 30 秒                         |
| `15:10`      | 今天 15:10（已过则到明天）          |
| `15:10:10`   | 今天 15:10:10（已过则到明天）        |

---

## 文件结构

```
traytimer.py             ← 主程序
timer.ico                ← 图标（可选，Windows推荐）
~/.config/timer.log      ← Linux 日志
%APPDATA%\timer.log      ← Windows 日志
```

---

## 开发与贡献

- 语言：Python 3 + PyQt5
- 依赖：仅需 PyQt5
- 欢迎交流和 PR！

> **极致极简，专注不打扰的计时器。**
